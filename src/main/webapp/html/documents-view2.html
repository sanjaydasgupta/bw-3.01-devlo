<div class="panel panel-primary">
  <div class="panel-heading">
    View Documents
  </div>

  <div class="panel-body fixed-panel container-fluid" style="padding:5px">
    <!-- Search -->
    <div class="row center-block" style="padding:5px 5px; border:2px solid #337ab7; width:100%">
      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" style="padding:0px;">
        <table width="100%">
          <tr><th style="background-color:#337ab7; text-align:center; color:white;">Document Search</th></tr>
        </table>
      </div>
      <div class="col-xs-12 col-sm-4 col-md-4 col-lg-2" style="padding:3px; border:1px solid #337ab7;">
        &nbsp;&nbsp;<span style="font-weight:bold;">Category</span>&nbsp;
        <div class="btn-group" data-uib-dropdown data-dropdown-append-to="appendToEl">
          <button id="btn-type" type="button" class="btn btn-info btn-xs" data-uib-dropdown-toggle>
            {{viewDocsCtrl.currentCategoryKey}} <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" data-uib-dropdown-menu role="menu" aria-labelledby="btn-type"
              style="min-width:50px">
            <li class="dropdown-item" data-ng-repeat="category in viewDocsCtrl.documentCategories">
              <a href="javascript:void(0)" style="padding:3px;"
                 data-ng-click="viewDocsCtrl.fetchDocumentsByCategory(category)">{{category}}</a>
            </li>
            <li class="divider" style="margin:1px;"></li>
            <li class="dropdown-item"><a href="javascript:void(0)"
                data-ng-click="viewDocsCtrl.fetchDocumentsByCategory('Any')" style="padding:3px;">Any</a></li>
          </ul>
        </div>
      </div>
      <div class="col-xs-12 col-sm-4 col-md-4 col-lg-2" style="padding:3px; border:1px solid #337ab7;">
        &nbsp;&nbsp;<span style="font-weight:bold;">Subcategory</span>&nbsp;
        <div class="btn-group" data-uib-dropdown data-dropdown-append-to="appendToEl">
          <button id="btn-subcategory" type="button" class="btn btn-info btn-xs" data-uib-dropdown-toggle>
            {{viewDocsCtrl.currentSubcategoryKey}} <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" data-uib-dropdown-menu role="menu" aria-labelledby="btn-subcategory"
              style="min-width:50px">
            <li class="dropdown-item" data-ng-repeat="subcategory in viewDocsCtrl.documentSubcategories"><a href="javascript:void(0)"
                data-ng-click="viewDocsCtrl.fetchDocumentsBySubcategory(subcategory)" style="padding:3px;">{{subcategory}}</a></li>
            <li class="divider" style="margin:1px;"></li>
            <li class="dropdown-item"><a href="javascript:void(0)"
                data-ng-click="viewDocsCtrl.fetchDocumentsBySubcategory('Any')" style="padding:3px;">Any</a></li>
          </ul>
        </div>
      </div>
      <div class="col-xs-12 col-sm-4 col-md-4 col-lg-2" style="padding:3px; border:1px solid #337ab7;">
        &nbsp;&nbsp;Content&nbsp;
        <div class="btn-group" data-uib-dropdown data-dropdown-append-to="appendToEl">
          <button id="btn-content" type="button" class="btn btn-info btn-xs" data-uib-dropdown-toggle>
            {{viewDocsCtrl.currentContentKey}} <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" data-uib-dropdown-menu role="menu" aria-labelledby="btn-content"
              style="min-width:50px">
            <li class="dropdown-item" data-ng-repeat="contentType in viewDocsCtrl.contentTypes"><a href="javascript:void(0)"
                data-ng-click="viewDocsCtrl.fetchDocumentsByContent(contentType)" style="padding:3px;">{{contentType}}</a></li>
            <li class="divider" style="margin:1px;"></li>
            <li class="dropdown-item"><a href="javascript:void(0)"
                data-ng-click="viewDocsCtrl.fetchDocumentsByContent('Any')" style="padding:3px;">Any</a></li>
          </ul>
        </div>
      </div>
      <div class="col-xs-12 col-sm-4 col-md-4 col-lg-2" style="padding:3px; border:1px solid #337ab7;">
        &nbsp;&nbsp;Name&nbsp;
        <input type="text" data-ng-model="viewDocsCtrl.documentName" size="15" style="height:20px; margin:1px;" />
      </div>
      <div class="col-xs-12 col-sm-4 col-md-4 col-lg-2" style="padding:3px; border:1px solid #337ab7;">
        &nbsp;&nbsp;Descr&nbsp;
        <input type="text" data-ng-model="viewDocsCtrl.documentDescription" size="15" style="height:20px; margin:1px;" />
      </div>
      <div class="col-xs-12 col-sm-4 col-md-4 col-lg-2" style="padding:3px; border:1px solid #337ab7;">
        <button class="btn btn-xs btn-primary" data-ng-click="viewDocsCtrl.findDocuments()"><span class="glyphicon glyphicon-search"></span> Find</button>
      </div>
    </div>
    <!-- Found Documents Table (displayed conditionally) -->
    <div data-ng-if="viewDocsCtrl.findModeActive" class="row center-block" style="padding:5px 5px; margin-top:3px; border:2px solid #337ab7; width:100% vertical-align:top;">
      <table width="100%">
        <tr><th style="background-color:#337ab7; text-align:center; color:white;">Documents ({{viewDocsCtrl.documents.length}})</th></tr>
      </table>
      <div style="height:200px; max-height:200px; min-height:200px; overflow:auto;">
        <table border="1" width="100%">
          <tr><th style="text-align:center;">Name</th><th style="text-align:center;">Description</th><th style="text-align:center;">Version Comments</th>
            <th style="text-align:center;">Date & Time</th><th style="text-align:center;">Author</th>
            <th style="text-align:center;">Download</th><th style="text-align:center;">RFI</th></tr>
          <tr data-ng-repeat="document in viewDocsCtrl.documents" style="background-color:{{viewDocsCtrl.getRowColor(document)}};">
            <td style="text-align:center;">{{document.name}}</td><td style="text-align:center;">{{document.description}}</td><td style="text-align:center;">{{document.comments}}</td>
            <td style="text-align:center;">{{document.date_time}}</td><td style="text-align:center;">{{document.author}}</td>
            <td style="text-align:center;"><a href="{{document.link}}" target="_blank">download</a></td>
            <td style="text-align:center;">
              <a href="javascript:void(0);" data-ng-click="viewDocsCtrl.selectDocument(document)">={{document.rfi_ids.length}}=</a>
            </td>
          </tr>
        </table>
      </div>
    </div>
    <!-- RFI Table -->
    <div data-ng-if="viewDocsCtrl.selectedDocument != null && viewDocsCtrl.rfiList.length > 0"
         class="row center-block" style="padding:5px 5px; margin-top:3px; border:2px solid #337ab7; width:100% vertical-align:top;">
      <table width="100%">
        <tr data-ng-if="viewDocsCtrl.selectedRfi != null"><th style="background-color:#337ab7; text-align:center; color:white;">{{viewDocsCtrl.selectedRfi.subject}}</th></tr>
        <tr data-ng-if="viewDocsCtrl.selectedRfi == null"><th style="background-color:#337ab7; text-align:center; color:white;">RFIs ({{viewDocsCtrl.rfiList.length}} Found)</th></tr>
      </table>
      <div data-ng-if="viewDocsCtrl.selectedRfi == null" style="height:100px; max-height:100px; min-height:100px; overflow:auto;">
        <table border="1" width="100%">
          <tr><th style="text-align:center;">Timestamp</th><th style="text-align:center;">Subject</th><th style="text-align:center;">Members</th><th style="text-align:center;">Count</th>
            <th style="text-align:center;">Last Message</th><th style="text-align:center;">Sender</th><th style="text-align:center;">Select</th></tr>
          <tr data-ng-repeat="rfi in viewDocsCtrl.rfiList">
            <td style="text-align:center;">{{rfi.timestamp}}</td><td style="text-align:center;">{{rfi.subject}}</td>
            <td style="text-align:center;">{{rfi.member_names.join(", ")}}</td><td style="text-align:center;">{{rfi.count}}</td>
            <td>{{rfi.last_message}}</td><td style="text-align:center;">{{rfi.sender}}</td>
            <td style="text-align:center;"><a href="javascript:void(0)" data-ng-click="viewDocsCtrl.selectRfi(rfi)">select</a></td>
          </tr>
        </table>
      </div>
      <div data-ng-if="viewDocsCtrl.selectedRfi != null" style="height:100px; max-height:100px; min-height:100px; overflow:auto;">
        <table border="1" width="100%">
          <tr><th style="text-align:center;">Timestamp</th><th style="text-align:center;">Sender</th><th style="text-align:center;">Message</th></tr>
          <tr data-ng-repeat="detail in viewDocsCtrl.rfiDetails">
            <td style="text-align:center;">{{detail.timestamp}}</td><td style="text-align:center;">{{detail.sender}}</td><td>{{detail.text}}</td>
          </tr>
        </table>
      </div>
      <hr style="margin:2px;"/>
      <table width="100%">
        <tr><td width="100%" class="pull-right">
          <button data-ng-if="viewDocsCtrl.selectedRfi == null" class="btn btn-xs btn-primary pull-right" data-ng-click="viewDocsCtrl.refreshRfiList()">Refresh</button>
          <button data-ng-if="viewDocsCtrl.selectedRfi != null" class="btn btn-xs btn-primary pull-right" data-ng-click="viewDocsCtrl.selectRfi()">Back</button>
        </td></tr>
      </table>
    </div>
    <!-- New-RFI or Response Table -->
    <div data-ng-if="viewDocsCtrl.selectedDocument != null"  class="row center-block" style="padding:5px 5px; margin-top:3px; border:2px solid #337ab7; width:100% vertical-align:top;">
      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" style="padding:0px;">
        <table width="100%">
          <tr data-ng-if="viewDocsCtrl.selectedRfi != null"><th style="background-color:#337ab7; text-align:center; color:white;">Respond to RFI</th></tr>
          <tr data-ng-if="viewDocsCtrl.selectedRfi == null"><th style="background-color:#337ab7; text-align:center; color:white;">Start New RFI</th></tr>
        </table>
      </div>
      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12" style="padding:3px; border:1px solid #337ab7;">
        <table width="100%">
          <tr><td>Subject</td><td width="95%"><input type="text" data-ng-model="viewDocsCtrl.newSubject"
              style="height:20px; margin:1px; width:90%;" /></td>
            <td rowspan="2" width="5%"><button class="btn btn-xs btn-primary" data-ng-disabled="viewDocsCtrl.sendDisabled()"
                data-ng-click="viewDocsCtrl.submitRFI()">Send</button></td>
          </tr>
          <tr>
            <td>Text</td><td><textarea data-ng-model="viewDocsCtrl.newText" style="height:20px; width:90%;"></textarea></td>
          </tr>
        </table>
      </div>
    </div>
  </div>
</div>

