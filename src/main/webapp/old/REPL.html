<html>
  <head>
    <title>BuildWhiz REPL</title>
    <script type="text/javascript">
      xhr = null;
      xhrBusy = false;
      if (window.ActiveXObject) {
        xhr = new ActiveXObject("Microsoft.XMLHTTP");
      } else {
        xhr = new XMLHttpRequest();
      }
      xhr.onreadystatechange = function() {
        if (this.readyState == 4) {
          if (this.status >= 200 && this.status < 300) {
        	  $("#output-area").html(this.responseText);
          } else {
        	  alert("Problem status: " + this.status);
          }
        }
        xhrBusy = false;
      }
      function submitAction() {
        if (!xhrBusy) {
          xhrBusy = true;
          //xhr.open("POST", "repl");
          xhr.open("POST", "web/REPL");
          //alert($("#command-input").val())
          xhr.send($("#command-input").val());
        }
      }
      function setupRepl() {
    	$("#submit-button").bind("click", submitAction);  
      }
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  </head>
  <body onload="setupRepl()">
    <h2 align="center">JS REPL</h2>
    <table style="width: 100%; height: 80%;">
      <tr>
        <td style="width: 50%">
          <table style="width: 100%; height: 100%">
            <tr>
              <td style="width: 100%; height: 45%; background-color: black; color: yellow; vertical-align: top; font-family: monospace;">
                <span id="output-area"></span>
              </td>
            </tr>
            <tr>
              <td style="width: 100%; height: 45%; vertical-align: top; font-family: monospace;">
                <textarea id="command-input" name="command" style="width: 100%; height: 90%"></textarea>
              </td>
            </tr>
            <tr>
              <td>
                <input id = "submit-button" type="submit"/>
              </td>
            </tr>
          </table>
        </td>
        <td style="width: 50%; border: 1px solid gray; vertical-align: top">
          <div style="text-align: center; font-weight: bold; background-color: yellow;">Sample Code</div>
          <div style="vertical-align: top; font-family: monospace;">
          // import a package<br/>
          importPackage(java.util);<br/>
          println(new Date());<br/>
          // import a class<br/>
          importClass(org.camunda.bpm.engine.ProcessEngines);<br/>
          var pei = ProcessEngines.getProcessEngineInfos();<br/>
          println(pei);<br/>
          // Camunda default process engine is "defaultProcessEngine"<br/>
          println(defaultProcessEngine);<br/>
          var rts = defaultProcessEngine.getRuntimeService();<br/>
          //rts.signal("????");<br/>
          //rts.startProcessInstanceByKey("GetDocumentNoValidation", {fname: "Tom", lname: "Thumb"});<br/>
          //println("done");<br/>
          </div>
        </td>
      </tr>
    </table>
  </body>
</html>